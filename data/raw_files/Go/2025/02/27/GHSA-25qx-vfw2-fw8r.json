{
  "id": "GHSA-25qx-vfw2-fw8r",
  "summary": "Nomad Vulnerable to Allocation Directory Escape On Non-Existing File Paths Through Archive Unpacking",
  "details": "In HashiCorp Nomad and Nomad Enterprise from 0.6.1 up to 1.6.13, 1.7.10, and 1.8.2, the archive unpacking process is vulnerable to writes outside the allocation directory during migration of allocation directories when multiple archive headers target the same file. This vulnerability, CVE-2024-7625, is fixed in Nomad 1.6.14, 1.7.11, and 1.8.3. Access or compromise of the Nomad client agent at the source allocation first is a prerequisite for leveraging this vulnerability.",
  "aliases": [
    "CVE-2024-7625",
    "GO-2024-3073"
  ],
  "modified": "2024-09-25T19:27:54Z",
  "published": "2024-08-15T00:30:59Z",
  "database_specific": {
    "nvd_published_at": "2024-08-15T00:15:13Z",
    "cwe_ids": [
      "CWE-610"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2024-08-15T21:24:57Z"
  },
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-7625"
    },
    {
      "type": "WEB",
      "url": "https://discuss.hashicorp.com/t/hcsec-2024-17-nomad-vulnerable-to-allocation-directory-escape-on-non-existing-file-paths-through-archive-unpacking/69293"
    },
    {
      "type": "PACKAGE",
      "url": "github.com/hashicorp/nomad"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "github.com/hashicorp/nomad",
        "ecosystem": "Go",
        "purl": "pkg:golang/github.com/hashicorp/nomad"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.6.1"
            },
            {
              "fixed": "1.6.14"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-25qx-vfw2-fw8r/GHSA-25qx-vfw2-fw8r.json"
      }
    },
    {
      "package": {
        "name": "github.com/hashicorp/nomad",
        "ecosystem": "Go",
        "purl": "pkg:golang/github.com/hashicorp/nomad"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.7.0"
            },
            {
              "fixed": "1.7.11"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-25qx-vfw2-fw8r/GHSA-25qx-vfw2-fw8r.json"
      }
    },
    {
      "package": {
        "name": "github.com/hashicorp/nomad",
        "ecosystem": "Go",
        "purl": "pkg:golang/github.com/hashicorp/nomad"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.8.0"
            },
            {
              "fixed": "1.8.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-25qx-vfw2-fw8r/GHSA-25qx-vfw2-fw8r.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N"
    },
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:N/VI:N/VA:N/SC:N/SI:H/SA:N"
    }
  ]
}